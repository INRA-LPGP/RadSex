\hypertarget{classAnalysis}{}\doxysection{Analysis Class Reference}
\label{classAnalysis}\index{Analysis@{Analysis}}


Base class for analyses subclasses.  




{\ttfamily \#include $<$analysis.\+h$>$}

Inheritance diagram for Analysis\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classAnalysis}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classAnalysis_a1cf251eb8dc62b30815ab5548ad88f73}\label{classAnalysis_a1cf251eb8dc62b30815ab5548ad88f73}} 
\mbox{\hyperlink{classAnalysis_a1cf251eb8dc62b30815ab5548ad88f73}{Analysis}} ()
\begin{DoxyCompactList}\small\item\em Default \mbox{\hyperlink{classAnalysis}{Analysis}} constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classAnalysis_af18036e8887f9ae9f2cdf9a6ec8fb671}{Analysis}} (\mbox{\hyperlink{structParameters}{Parameters}} \&\mbox{\hyperlink{classAnalysis_a8abd4de209925cb46571d4db97977d32}{parameters}}, bool \mbox{\hyperlink{classAnalysis_a744305d7fed1cc583580c5920f0e39b2}{compare\+\_\+groups}}, bool \mbox{\hyperlink{classAnalysis_acb2ede1501279963996f5e42eea88cca}{store\+\_\+groups}}, bool \mbox{\hyperlink{classAnalysis_a8b6e589cb74d4c25dcdcd88665a07060}{store\+\_\+sequence}})
\begin{DoxyCompactList}\small\item\em Standard \mbox{\hyperlink{classAnalysis}{Analysis}} constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classAnalysis_ac004e11b85ddb125c7e7844ba2be728b}{print\+\_\+starting\+\_\+log}} ()
\begin{DoxyCompactList}\small\item\em Print analysis starting log. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classAnalysis_a2967c5ac0d5e431284a90559ecf72db8}{print\+\_\+groups}} ()
\begin{DoxyCompactList}\small\item\em Print group counts. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classAnalysis_a4ea445a5e04a775edc7ed14effe737ad}{print\+\_\+ending\+\_\+log}} ()
\begin{DoxyCompactList}\small\item\em Print analysis ending log. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classAnalysis_a51c4499fc36d5d27bdbb2cdeb30aee28}{processor}} ()
\begin{DoxyCompactList}\small\item\em Process batches of markers. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classAnalysis_a8ef67dd0d4117235919b901dc578ce1e}{run}} ()
\begin{DoxyCompactList}\small\item\em Run the analysis. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classAnalysis_a869888497ba90db335e127f3c13d19b4}{extra\+\_\+setup}} ()
\begin{DoxyCompactList}\small\item\em Extra setup steps. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classAnalysis_ac2c749dc8512a6ef200042e59c4369bc}{process\+\_\+marker}} (\mbox{\hyperlink{classMarker}{Marker}} \&)
\begin{DoxyCompactList}\small\item\em Process a single marker. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classAnalysis_a23da6dbd599ede2e4973a0313128f428}{generate\+\_\+output}} ()
\begin{DoxyCompactList}\small\item\em Generate output. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classAnalysis_a374bce02ff89fc2b6210a85c79d6bb15}\label{classAnalysis_a374bce02ff89fc2b6210a85c79d6bb15}} 
std\+::chrono\+::steady\+\_\+clock\+::time\+\_\+point \mbox{\hyperlink{classAnalysis_a374bce02ff89fc2b6210a85c79d6bb15}{t\+\_\+begin}}
\begin{DoxyCompactList}\small\item\em Record analysis starting time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classAnalysis_a8abd4de209925cb46571d4db97977d32}\label{classAnalysis_a8abd4de209925cb46571d4db97977d32}} 
\mbox{\hyperlink{structParameters}{Parameters}} \mbox{\hyperlink{classAnalysis_a8abd4de209925cb46571d4db97977d32}{parameters}}
\begin{DoxyCompactList}\small\item\em Store R\+A\+D\+Sex parameters. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classAnalysis_a744305d7fed1cc583580c5920f0e39b2}\label{classAnalysis_a744305d7fed1cc583580c5920f0e39b2}} 
bool \mbox{\hyperlink{classAnalysis_a744305d7fed1cc583580c5920f0e39b2}{compare\+\_\+groups}}
\begin{DoxyCompactList}\small\item\em Flag indicating whether groups should be checked when loading the popmap. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classAnalysis_acb2ede1501279963996f5e42eea88cca}\label{classAnalysis_acb2ede1501279963996f5e42eea88cca}} 
bool \mbox{\hyperlink{classAnalysis_acb2ede1501279963996f5e42eea88cca}{store\+\_\+groups}}
\begin{DoxyCompactList}\small\item\em Flag indicating whether group info should be computed for each marker when parsing the markers table. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classAnalysis_a8b6e589cb74d4c25dcdcd88665a07060}\label{classAnalysis_a8b6e589cb74d4c25dcdcd88665a07060}} 
bool \mbox{\hyperlink{classAnalysis_a8b6e589cb74d4c25dcdcd88665a07060}{store\+\_\+sequence}}
\begin{DoxyCompactList}\small\item\em Flag indicating whether marker sequences should be stored for each marker when parsing the markers table. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classAnalysis_a964cb61cb6b983aefe7fb2f272d1a330}\label{classAnalysis_a964cb61cb6b983aefe7fb2f272d1a330}} 
\mbox{\hyperlink{classPopmap}{Popmap}} \mbox{\hyperlink{classAnalysis_a964cb61cb6b983aefe7fb2f272d1a330}{popmap}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classPopmap}{Popmap}} instance storing group for each individual. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classAnalysis_a3b9bc8b0dcc0ecea11d3a12969397ba7}\label{classAnalysis_a3b9bc8b0dcc0ecea11d3a12969397ba7}} 
\mbox{\hyperlink{classMarkersTable}{Markers\+Table}} \mbox{\hyperlink{classAnalysis_a3b9bc8b0dcc0ecea11d3a12969397ba7}{markers\+\_\+table}}
\begin{DoxyCompactList}\small\item\em Markers table instance implementing the markers table parser and markers queue. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classAnalysis_ab6ccc551c96b9052a0c2ada31fac5fa3}\label{classAnalysis_ab6ccc551c96b9052a0c2ada31fac5fa3}} 
std\+::thread \mbox{\hyperlink{classAnalysis_ab6ccc551c96b9052a0c2ada31fac5fa3}{parsing\+\_\+thread}}
\begin{DoxyCompactList}\small\item\em Markers table parsing thread. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classAnalysis_ab8a28883cbf6fc539e8f07a9ad15f204}\label{classAnalysis_ab8a28883cbf6fc539e8f07a9ad15f204}} 
std\+::thread \mbox{\hyperlink{classAnalysis_ab8a28883cbf6fc539e8f07a9ad15f204}{processing\+\_\+thread}}
\begin{DoxyCompactList}\small\item\em Markers processing thread. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Base class for analyses subclasses. 

This class implements methods and attributes shared by all analyses\+:


\begin{DoxyItemize}
\item Load parameters, load popmap, and initialize markers table parser in the constructor
\item Start markers table parsing thread and marker processing thread in \mbox{\hyperlink{classAnalysis_a8ef67dd0d4117235919b901dc578ce1e}{run()}}
\item Read batches of markers from the markers queue in \mbox{\hyperlink{classAnalysis_a51c4499fc36d5d27bdbb2cdeb30aee28}{processor()}}
\end{DoxyItemize}

Three virtual methods are defined to implement analyses-\/specific behaviour\+:


\begin{DoxyItemize}
\item \mbox{\hyperlink{classAnalysis_a869888497ba90db335e127f3c13d19b4}{extra\+\_\+setup()}}\+: called at the beginning of \mbox{\hyperlink{classAnalysis_a8ef67dd0d4117235919b901dc578ce1e}{run()}}, implement analysis-\/specific variables setup (e.\+g. B\+WA index in map function)
\item \mbox{\hyperlink{classAnalysis_ac2c749dc8512a6ef200042e59c4369bc}{process\+\_\+marker()}}\+: called for each marker obtained from the markers queue, implement what to do with a marker
\item \mbox{\hyperlink{classAnalysis_a23da6dbd599ede2e4973a0313128f428}{generate\+\_\+output()}}\+: called at the end of \mbox{\hyperlink{classAnalysis_a8ef67dd0d4117235919b901dc578ce1e}{run()}}, implement generating output file when needed 
\end{DoxyItemize}

Definition at line 48 of file analysis.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classAnalysis_af18036e8887f9ae9f2cdf9a6ec8fb671}\label{classAnalysis_af18036e8887f9ae9f2cdf9a6ec8fb671}} 
\index{Analysis@{Analysis}!Analysis@{Analysis}}
\index{Analysis@{Analysis}!Analysis@{Analysis}}
\doxysubsubsection{\texorpdfstring{Analysis()}{Analysis()}}
{\footnotesize\ttfamily Analysis\+::\+Analysis (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structParameters}{Parameters}} \&}]{parameters,  }\item[{bool}]{compare\+\_\+groups,  }\item[{bool}]{store\+\_\+groups,  }\item[{bool}]{store\+\_\+sequence }\end{DoxyParamCaption})}



Standard \mbox{\hyperlink{classAnalysis}{Analysis}} constructor. 

Initialize \mbox{\hyperlink{classMarkersTable}{Markers\+Table}} instance, load parameters and popmap


\begin{DoxyParams}{Parameters}
{\em parameters} & \mbox{\hyperlink{structParameters}{Parameters}} object storing the value of all R\+A\+D\+Sex parameters \\
\hline
{\em compare\+\_\+groups} & If true, groups are checked when loading the popmap \\
\hline
{\em store\+\_\+groups} & If true, group info is computed for each marker when parsing the markers table \\
\hline
{\em store\+\_\+sequence} & If true, marker sequences are stored for each marker when parsing the markers table \\
\hline
\end{DoxyParams}


Definition at line 28 of file analysis.\+cpp.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classAnalysis_a869888497ba90db335e127f3c13d19b4}\label{classAnalysis_a869888497ba90db335e127f3c13d19b4}} 
\index{Analysis@{Analysis}!extra\_setup@{extra\_setup}}
\index{extra\_setup@{extra\_setup}!Analysis@{Analysis}}
\doxysubsubsection{\texorpdfstring{extra\_setup()}{extra\_setup()}}
{\footnotesize\ttfamily virtual void Analysis\+::extra\+\_\+setup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Extra setup steps. 

Function to be overloaded to implement extra setup steps required by an analysis, called at the beginning of \mbox{\hyperlink{classAnalysis_a8ef67dd0d4117235919b901dc578ce1e}{run()}}. 

Reimplemented in \mbox{\hyperlink{classMap_ad084e065185199c750be50698196d840}{Map}}, and \mbox{\hyperlink{classSubset_a935a07811cb720682e7b9a6435dd744e}{Subset}}.



Definition at line 139 of file analysis.\+h.



Referenced by run().

\mbox{\Hypertarget{classAnalysis_a23da6dbd599ede2e4973a0313128f428}\label{classAnalysis_a23da6dbd599ede2e4973a0313128f428}} 
\index{Analysis@{Analysis}!generate\_output@{generate\_output}}
\index{generate\_output@{generate\_output}!Analysis@{Analysis}}
\doxysubsubsection{\texorpdfstring{generate\_output()}{generate\_output()}}
{\footnotesize\ttfamily virtual void Analysis\+::generate\+\_\+output (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Generate output. 

Function to be overloaded to implement output file generation when required by an analysis, called at the end of \mbox{\hyperlink{classAnalysis_a8ef67dd0d4117235919b901dc578ce1e}{run()}}. 

Reimplemented in \mbox{\hyperlink{classMap_ad91fb61d49cef731fd4d230634fd4cf9}{Map}}, \mbox{\hyperlink{classDepth_ae6a61dccfa80095ac6fd81d27b01ba50}{Depth}}, \mbox{\hyperlink{classSignif_ac64b0e21aed03d3ef10ff1a0f1cea654}{Signif}}, \mbox{\hyperlink{classDistrib_a7e5c6dadcaf6f5700ee594ad3b9fc0cc}{Distrib}}, and \mbox{\hyperlink{classFreq_a9aecef076766747e9a1ed5eee9a41ec2}{Freq}}.



Definition at line 157 of file analysis.\+h.



Referenced by run().

\mbox{\Hypertarget{classAnalysis_a4ea445a5e04a775edc7ed14effe737ad}\label{classAnalysis_a4ea445a5e04a775edc7ed14effe737ad}} 
\index{Analysis@{Analysis}!print\_ending\_log@{print\_ending\_log}}
\index{print\_ending\_log@{print\_ending\_log}!Analysis@{Analysis}}
\doxysubsubsection{\texorpdfstring{print\_ending\_log()}{print\_ending\_log()}}
{\footnotesize\ttfamily void Analysis\+::print\+\_\+ending\+\_\+log (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Print analysis ending log. 

Print ending log message with total runtime 

Definition at line 67 of file analysis.\+cpp.



Referenced by run().

\mbox{\Hypertarget{classAnalysis_a2967c5ac0d5e431284a90559ecf72db8}\label{classAnalysis_a2967c5ac0d5e431284a90559ecf72db8}} 
\index{Analysis@{Analysis}!print\_groups@{print\_groups}}
\index{print\_groups@{print\_groups}!Analysis@{Analysis}}
\doxysubsubsection{\texorpdfstring{print\_groups()}{print\_groups()}}
{\footnotesize\ttfamily void Analysis\+::print\+\_\+groups (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Print group counts. 

Print log message with group counts for groups compared by an analysis 

Definition at line 57 of file analysis.\+cpp.



Referenced by print\+\_\+starting\+\_\+log().

\mbox{\Hypertarget{classAnalysis_ac004e11b85ddb125c7e7844ba2be728b}\label{classAnalysis_ac004e11b85ddb125c7e7844ba2be728b}} 
\index{Analysis@{Analysis}!print\_starting\_log@{print\_starting\_log}}
\index{print\_starting\_log@{print\_starting\_log}!Analysis@{Analysis}}
\doxysubsubsection{\texorpdfstring{print\_starting\_log()}{print\_starting\_log()}}
{\footnotesize\ttfamily void Analysis\+::print\+\_\+starting\+\_\+log (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Print analysis starting log. 

Print starting log message with the name of the analysis and group counts for analyses that make use of groups 

Definition at line 46 of file analysis.\+cpp.



Referenced by run().

\mbox{\Hypertarget{classAnalysis_ac2c749dc8512a6ef200042e59c4369bc}\label{classAnalysis_ac2c749dc8512a6ef200042e59c4369bc}} 
\index{Analysis@{Analysis}!process\_marker@{process\_marker}}
\index{process\_marker@{process\_marker}!Analysis@{Analysis}}
\doxysubsubsection{\texorpdfstring{process\_marker()}{process\_marker()}}
{\footnotesize\ttfamily virtual void Analysis\+::process\+\_\+marker (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMarker}{Marker}} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Process a single marker. 

Function to be overloaded to implement processing of a single marker in an analysis, called on each marker by \mbox{\hyperlink{classAnalysis_a51c4499fc36d5d27bdbb2cdeb30aee28}{processor()}}. 

Reimplemented in \mbox{\hyperlink{classMap_a8fa38748c4e54b0dd974915a7a8711c9}{Map}}, \mbox{\hyperlink{classDepth_ae4dfa2cdf3e813701f4842af1f4de7d3}{Depth}}, \mbox{\hyperlink{classDistrib_a1f78b878194bdc7a2b182c9b32d3eb33}{Distrib}}, \mbox{\hyperlink{classSignif_ac06a653925053d81985a36dcf6e96ad2}{Signif}}, \mbox{\hyperlink{classSubset_a546e6785585f2c3b25f8f1d53ac80cdf}{Subset}}, and \mbox{\hyperlink{classFreq_a2b3d992be4c88bdb717313fba3b61646}{Freq}}.



Definition at line 148 of file analysis.\+h.



Referenced by processor().

\mbox{\Hypertarget{classAnalysis_a51c4499fc36d5d27bdbb2cdeb30aee28}\label{classAnalysis_a51c4499fc36d5d27bdbb2cdeb30aee28}} 
\index{Analysis@{Analysis}!processor@{processor}}
\index{processor@{processor}!Analysis@{Analysis}}
\doxysubsubsection{\texorpdfstring{processor()}{processor()}}
{\footnotesize\ttfamily void Analysis\+::processor (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Process batches of markers. 

Get a batch of markers from the markers queue and call \mbox{\hyperlink{classAnalysis_ac2c749dc8512a6ef200042e59c4369bc}{process\+\_\+marker()}} on each marker. ~\newline
Wait if queue is empty and update progress bar with processed markers. 

Definition at line 97 of file analysis.\+cpp.



Referenced by run().

\mbox{\Hypertarget{classAnalysis_a8ef67dd0d4117235919b901dc578ce1e}\label{classAnalysis_a8ef67dd0d4117235919b901dc578ce1e}} 
\index{Analysis@{Analysis}!run@{run}}
\index{run@{run}!Analysis@{Analysis}}
\doxysubsubsection{\texorpdfstring{run()}{run()}}
{\footnotesize\ttfamily void Analysis\+::run (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Run the analysis. 

Start the parsing and processing threads and print logs at start and end. Call \mbox{\hyperlink{classAnalysis_a869888497ba90db335e127f3c13d19b4}{extra\+\_\+setup()}} and the start and \mbox{\hyperlink{classAnalysis_a23da6dbd599ede2e4973a0313128f428}{generate\+\_\+output()}} at the end. 

Definition at line 77 of file analysis.\+cpp.



Referenced by main().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/romain/work/code/\+Rad\+Sex/src/\mbox{\hyperlink{analysis_8h}{analysis.\+h}}\item 
/home/romain/work/code/\+Rad\+Sex/src/\mbox{\hyperlink{analysis_8cpp}{analysis.\+cpp}}\end{DoxyCompactItemize}
