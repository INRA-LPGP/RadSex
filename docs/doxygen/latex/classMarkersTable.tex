\hypertarget{classMarkersTable}{}\doxysection{Markers\+Table Class Reference}
\label{classMarkersTable}\index{MarkersTable@{MarkersTable}}


\mbox{\hyperlink{classMarkersTable}{Markers\+Table}} class.  




{\ttfamily \#include $<$markers\+\_\+table.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classMarkersTable_a361b7beaac73a56a09e02c15a022da09}\label{classMarkersTable_a361b7beaac73a56a09e02c15a022da09}} 
\mbox{\hyperlink{classMarkersTable_a361b7beaac73a56a09e02c15a022da09}{Markers\+Table}} ()
\begin{DoxyCompactList}\small\item\em Default \mbox{\hyperlink{classMarkersTable}{Markers\+Table}} constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMarkersTable_aa286cd1b03c2de7922a5489c3d66b084}{Markers\+Table}} (\mbox{\hyperlink{structParameters}{Parameters}} $\ast$\mbox{\hyperlink{classMarkersTable_a3fee39a79360c19baf0b92b66d11b37d}{parameters}})
\begin{DoxyCompactList}\small\item\em Standard \mbox{\hyperlink{classMarkersTable}{Markers\+Table}} constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMarkersTable_a8a7cb5c1852a51b1f06240e1803c4d42}{start\+\_\+parser}} (bool store\+\_\+sequence=true, bool compute\+\_\+groups=true)
\begin{DoxyCompactList}\small\item\em Read markers from a markers depth table and store them in a queue. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMarkersTable_a679afbfb05e8a547553173a5b228cff4}{get\+\_\+batch}} (std\+::vector$<$ \mbox{\hyperlink{classMarker}{Marker}} $>$ \&batch)
\begin{DoxyCompactList}\small\item\em Get a batch of markers from the queue. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMarkersTable_ae80ae39dcaca919f152b3b4fe414099f}{set\+\_\+popmap}} (\mbox{\hyperlink{classPopmap}{Popmap}} $\ast$\mbox{\hyperlink{classMarkersTable_a159cf9eee866249e0040e4f0f481cea3}{popmap}})
\begin{DoxyCompactList}\small\item\em Set the popmap attribute value. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classMarkersTable_a355de34437483f69d063ebae100a8089}\label{classMarkersTable_a355de34437483f69d063ebae100a8089}} 
\mbox{\hyperlink{classHeader}{Header}} \mbox{\hyperlink{classMarkersTable_a355de34437483f69d063ebae100a8089}{header}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classHeader}{Header}} instance storing information about the markers table. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMarkersTable_a169656fd6d7d040836f0efc39407fe6f}\label{classMarkersTable_a169656fd6d7d040836f0efc39407fe6f}} 
std\+::queue$<$ \mbox{\hyperlink{classMarker}{Marker}} $>$ \mbox{\hyperlink{classMarkersTable_a169656fd6d7d040836f0efc39407fe6f}{markers\+\_\+queue}}
\begin{DoxyCompactList}\small\item\em Queue of \mbox{\hyperlink{classMarker}{Marker}} objects to be processed in an analysis. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMarkersTable_a37c62386315842faf858d2dadb5ec2e8}\label{classMarkersTable_a37c62386315842faf858d2dadb5ec2e8}} 
uint64\+\_\+t \mbox{\hyperlink{classMarkersTable_a37c62386315842faf858d2dadb5ec2e8}{n\+\_\+markers\+\_\+processed}} = 0
\begin{DoxyCompactList}\small\item\em Total number of markers loaded from the markers table. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMarkersTable_aaa797d9ad11ca87e29eb96eca6ad2837}\label{classMarkersTable_aaa797d9ad11ca87e29eb96eca6ad2837}} 
std\+::mutex \mbox{\hyperlink{classMarkersTable_aaa797d9ad11ca87e29eb96eca6ad2837}{mutex}}
\begin{DoxyCompactList}\small\item\em Mutex to protect the markers queue when pushing / reading batches of markers. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMarkersTable_adb785ba9192296a6e086b69330ca1258}\label{classMarkersTable_adb785ba9192296a6e086b69330ca1258}} 
bool \mbox{\hyperlink{classMarkersTable_adb785ba9192296a6e086b69330ca1258}{parsing\+\_\+ended}} = false
\begin{DoxyCompactList}\small\item\em Flag indicating whether parsing of the markers table ended. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMarkersTable_a73acda779eb818aa7fb59e8ff5ba27ea}\label{classMarkersTable_a73acda779eb818aa7fb59e8ff5ba27ea}} 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classMarkersTable_a73acda779eb818aa7fb59e8ff5ba27ea}{groups}}
\begin{DoxyCompactList}\small\item\em Vector storing the group (obtained from the popmap) for each individual based on column indices. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classMarkersTable_a8e735d138893920428944c495e4b7df8}{get\+\_\+group\+\_\+columns}} ()
\begin{DoxyCompactList}\small\item\em Get group for each column in the markers table. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classMarkersTable_a3fee39a79360c19baf0b92b66d11b37d}\label{classMarkersTable_a3fee39a79360c19baf0b92b66d11b37d}} 
\mbox{\hyperlink{structParameters}{Parameters}} $\ast$ \mbox{\hyperlink{classMarkersTable_a3fee39a79360c19baf0b92b66d11b37d}{parameters}}
\begin{DoxyCompactList}\small\item\em Pointer to a \mbox{\hyperlink{structParameters}{Parameters}} instance storing all R\+A\+D\+Sex parameters. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMarkersTable_a159cf9eee866249e0040e4f0f481cea3}\label{classMarkersTable_a159cf9eee866249e0040e4f0f481cea3}} 
\mbox{\hyperlink{classPopmap}{Popmap}} $\ast$ \mbox{\hyperlink{classMarkersTable_a159cf9eee866249e0040e4f0f481cea3}{popmap}}
\begin{DoxyCompactList}\small\item\em Pointer to a popmap instance storing group for each individual. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{classMarkersTable}{Markers\+Table}} class. 

This class stores information about a markers table file and implements two methods\+:


\begin{DoxyItemize}
\item \mbox{\hyperlink{classMarkersTable_a8a7cb5c1852a51b1f06240e1803c4d42}{start\+\_\+parser()}}\+: parse the markers table and store each marker in a queue of \mbox{\hyperlink{classMarker}{Marker}} objects
\item \mbox{\hyperlink{classMarkersTable_a679afbfb05e8a547553173a5b228cff4}{get\+\_\+batch()}}\+: get a batch of markers from the \mbox{\hyperlink{classMarker}{Marker}} queue to be processed in an analysis
\end{DoxyItemize}

These methods are implemented to be run on two concurrent threads (one thread each). 

Definition at line 84 of file markers\+\_\+table.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classMarkersTable_aa286cd1b03c2de7922a5489c3d66b084}\label{classMarkersTable_aa286cd1b03c2de7922a5489c3d66b084}} 
\index{MarkersTable@{MarkersTable}!MarkersTable@{MarkersTable}}
\index{MarkersTable@{MarkersTable}!MarkersTable@{MarkersTable}}
\doxysubsubsection{\texorpdfstring{MarkersTable()}{MarkersTable()}}
{\footnotesize\ttfamily Markers\+Table\+::\+Markers\+Table (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structParameters}{Parameters}} $\ast$}]{parameters }\end{DoxyParamCaption})}



Standard \mbox{\hyperlink{classMarkersTable}{Markers\+Table}} constructor. 

Initialize parameters and read the markers table header


\begin{DoxyParams}{Parameters}
{\em parameters} & Pointer to a Parameter object storing all R\+A\+D\+Sex parameter values \\
\hline
\end{DoxyParams}


Definition at line 58 of file markers\+\_\+table.\+cpp.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classMarkersTable_a679afbfb05e8a547553173a5b228cff4}\label{classMarkersTable_a679afbfb05e8a547553173a5b228cff4}} 
\index{MarkersTable@{MarkersTable}!get\_batch@{get\_batch}}
\index{get\_batch@{get\_batch}!MarkersTable@{MarkersTable}}
\doxysubsubsection{\texorpdfstring{get\_batch()}{get\_batch()}}
{\footnotesize\ttfamily void Markers\+Table\+::get\+\_\+batch (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \mbox{\hyperlink{classMarker}{Marker}} $>$ \&}]{batch }\end{DoxyParamCaption})}



Get a batch of markers from the queue. 

Read a batch of markers of size \mbox{\hyperlink{markers__table_8h_a9ae2958e436c566413867028fc829ec0}{B\+A\+T\+C\+H\+\_\+\+S\+I\+ZE}} and store it in the Markers vector batch.


\begin{DoxyParams}{Parameters}
{\em batch} & Vector of \mbox{\hyperlink{classMarker}{Marker}} objects storing the current markers batch \\
\hline
\end{DoxyParams}


Definition at line 211 of file markers\+\_\+table.\+cpp.



Referenced by Analysis\+::processor().

\mbox{\Hypertarget{classMarkersTable_a8e735d138893920428944c495e4b7df8}\label{classMarkersTable_a8e735d138893920428944c495e4b7df8}} 
\index{MarkersTable@{MarkersTable}!get\_group\_columns@{get\_group\_columns}}
\index{get\_group\_columns@{get\_group\_columns}!MarkersTable@{MarkersTable}}
\doxysubsubsection{\texorpdfstring{get\_group\_columns()}{get\_group\_columns()}}
{\footnotesize\ttfamily void Markers\+Table\+::get\+\_\+group\+\_\+columns (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Get group for each column in the markers table. 

Create a vector of groups to easily access a column\textquotesingle{}s groups by index. 

Definition at line 237 of file markers\+\_\+table.\+cpp.



Referenced by start\+\_\+parser().

\mbox{\Hypertarget{classMarkersTable_ae80ae39dcaca919f152b3b4fe414099f}\label{classMarkersTable_ae80ae39dcaca919f152b3b4fe414099f}} 
\index{MarkersTable@{MarkersTable}!set\_popmap@{set\_popmap}}
\index{set\_popmap@{set\_popmap}!MarkersTable@{MarkersTable}}
\doxysubsubsection{\texorpdfstring{set\_popmap()}{set\_popmap()}}
{\footnotesize\ttfamily void Markers\+Table\+::set\+\_\+popmap (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classPopmap}{Popmap}} $\ast$}]{popmap }\end{DoxyParamCaption})}



Set the popmap attribute value. 

Usually, the popmap is not yet loaded when the \mbox{\hyperlink{classMarkersTable}{Markers\+Table}} instance is created. This method is used to set the pointer to the \mbox{\hyperlink{classPopmap}{Popmap}} object after loading the popmap.


\begin{DoxyParams}{Parameters}
{\em popmap} & Pointer to a \mbox{\hyperlink{classPopmap}{Popmap}} object \\
\hline
\end{DoxyParams}


Definition at line 248 of file markers\+\_\+table.\+cpp.



Referenced by Analysis\+::\+Analysis().

\mbox{\Hypertarget{classMarkersTable_a8a7cb5c1852a51b1f06240e1803c4d42}\label{classMarkersTable_a8a7cb5c1852a51b1f06240e1803c4d42}} 
\index{MarkersTable@{MarkersTable}!start\_parser@{start\_parser}}
\index{start\_parser@{start\_parser}!MarkersTable@{MarkersTable}}
\doxysubsubsection{\texorpdfstring{start\_parser()}{start\_parser()}}
{\footnotesize\ttfamily void Markers\+Table\+::start\+\_\+parser (\begin{DoxyParamCaption}\item[{bool}]{store\+\_\+sequence = {\ttfamily true},  }\item[{bool}]{compute\+\_\+groups = {\ttfamily true} }\end{DoxyParamCaption})}



Read markers from a markers depth table and store them in a queue. 

Read a markers depth table generated with \mbox{\hyperlink{process_8cpp_aca1db66566c3a841900e42422a31736a}{process()}}. Each marker is stored in a \mbox{\hyperlink{classMarker}{Marker}} instance which is pushed to a queue. The function waits if the queue gets bigger than \mbox{\hyperlink{markers__table_8h_a623ec78b7909090dbedac4af1d52abb4}{M\+A\+X\+\_\+\+Q\+U\+E\+U\+E\+\_\+\+S\+I\+ZE}}. Batches of markers are obtained from the queue with \mbox{\hyperlink{classMarkersTable_a679afbfb05e8a547553173a5b228cff4}{get\+\_\+batch()}}.


\begin{DoxyParams}{Parameters}
{\em store\+\_\+sequence} & If true, marker sequences and I\+Ds are be stored in \mbox{\hyperlink{classMarker}{Marker}} objects \\
\hline
{\em compute\+\_\+groups} & If true, group counts are computed for each marker \\
\hline
\end{DoxyParams}


Definition at line 70 of file markers\+\_\+table.\+cpp.



Referenced by Analysis\+::run().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/romain/work/code/\+Rad\+Sex/src/\mbox{\hyperlink{markers__table_8h}{markers\+\_\+table.\+h}}\item 
/home/romain/work/code/\+Rad\+Sex/src/\mbox{\hyperlink{markers__table_8cpp}{markers\+\_\+table.\+cpp}}\end{DoxyCompactItemize}
